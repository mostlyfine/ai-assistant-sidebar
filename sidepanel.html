<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gemini Sidebar</title>
  <link rel="stylesheet" href="styles/sidepanel.css">
</head>
<body>
  <!-- APIË®≠ÂÆöÁîªÈù¢ -->
  <div id="setupScreen" class="screen">
    <div class="setup-container">
      <div class="header">
        <h1 data-i18n="appTitle">ü§ñ AI Assistant</h1>
        <p data-i18n="setupTitle">AI API„ÇíË®≠ÂÆö„Åó„Å¶„Åè„Å†„Åï„ÅÑ</p>
      </div>
      
      <!-- „Çø„Éñ„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ -->
      <div class="tab-navigation">
        <button class="tab-button active" data-tab="vertex-ai" data-i18n="tabVertexAI"><img src="icons/vertex.png" alt="Vertex AI" class="tab-icon"><span>Vertex AI</span></button>
        <button class="tab-button" data-tab="openai-compatible" data-i18n="tabOpenAICompatible"><img src="icons/openai.png" alt="OpenAI" class="tab-icon"><span>OpenAI Compatible</span></button>
        <button class="tab-button" data-tab="aws-bedrock" data-i18n="tabAWSBedrock"><img src="icons/bedrock.png" alt="AWS Bedrock" class="tab-icon"><span>AWS Bedrock</span></button>
        <button class="tab-button" data-tab="general" data-i18n="tabGeneral"><img src="icons/setting.png" alt="Ë®≠ÂÆö" class="tab-icon"><span>ÂÖ®‰ΩìË®≠ÂÆö</span></button>
      </div>

      <!-- Vertex AIË®≠ÂÆö„Çø„Éñ -->
      <div id="vertex-ai-tab" class="tab-content active">
        <h3 data-i18n="vertexAISettings">Vertex AI Ë®≠ÂÆö</h3>
        
        <!-- Ë™çË®ºÊñπÂºèÈÅ∏Êäû -->
        <div class="input-group">
          <label data-i18n="authMethod">Ë™çË®ºÊñπÂºè</label>
          <div class="auth-method-selection">
            <label class="radio-option">
              <input type="radio" name="vertexAuthMethod" value="service-account" checked>
              <span class="radio-custom"></span>
              <span data-i18n="serviceAccountJSON">Service Account JSON</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="vertexAuthMethod" value="api-key">
              <span class="radio-custom"></span>
              <span data-i18n="apiKey">API Key</span>
            </label>
          </div>
        </div>

        <!-- Service AccountË®≠ÂÆö -->
        <div id="serviceAccountSection">
          <div class="input-group">
            <label for="serviceAccountFile" data-i18n="serviceAccountFile">Service Account JSON „Éï„Ç°„Ç§„É´</label>
            <div class="file-input-container">
              <input type="file" id="serviceAccountFile" accept=".json" style="display: none;">
              <button type="button" id="selectFileButton" class="file-select-button">
                <span data-i18n="selectJSONFile">üìÅ JSON„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû</span>
              </button>
              <span id="selectedFileName" class="file-name"></span>
            </div>
          </div>
          
          <div class="service-account-info" id="serviceAccountInfo" style="display: none;">
            <h4 data-i18n="serviceAccountInfo">Service Account ÊÉÖÂ†±</h4>
            <div class="info-item">
              <span class="label" data-i18n="projectId">Project ID:</span>
              <span id="projectId"></span>
            </div>
            <div class="info-item">
              <span class="label" data-i18n="email">Email:</span>
              <span id="serviceAccountEmail"></span>
            </div>
            <div class="info-item">
              <span class="label" data-i18n="keyId">Key ID:</span>
              <span id="serviceAccountKeyId"></span>
            </div>
          </div>
        </div>

        <!-- API KeyË®≠ÂÆö -->
        <div id="apiKeySection" style="display: none;">
          <div class="input-group">
            <label for="vertexProjectId" data-i18n="projectId">Project ID</label>
            <input type="text" id="vertexProjectId" data-i18n-placeholder="placeholderGoogleCloudProjectId">
          </div>
          <div class="input-group">
            <label for="vertexApiKey" data-i18n="apiKey">API Key</label>
            <input type="password" id="vertexApiKey" data-i18n-placeholder="placeholderVertexApiKey">
          </div>
        </div>
        
        <div class="input-group" id="locationGroup" style="display: none;">
          <label for="location" data-i18n="location">Location („É™„Éº„Ç∏„Éß„É≥)</label>
          <select id="location">
            <option value="us-central1">us-central1</option>
            <option value="us-west1">us-west1</option>
            <option value="asia-northeast1">asia-northeast1</option>
            <option value="europe-west1">europe-west1</option>
          </select>
        </div>

        <div class="input-group" id="vertexModelGroup" style="display: none;">
          <label for="vertexModel" data-i18n="model">„É¢„Éá„É´</label>
          <select id="vertexModel">
            <option value="gemini-2.5-pro">gemini-2.5-pro</option>
            <option value="gemini-2.5-flash">gemini-2.5-flash</option>
            <option value="gemini-2.0-flash">gemini-2.0-flash</option>
            <option value="gemini-2.0-flash-exp">gemini-2.0-flash-exp (US only)</option>
            <option value="gemini-1.5-flash-002">gemini-1.5-flash-002</option>
            <option value="gemini-1.5-flash-001">gemini-1.5-flash-001</option>
            <option value="gemini-1.5-pro-002">gemini-1.5-pro-002</option>
            <option value="gemini-1.5-pro-001">gemini-1.5-pro-001</option>
            <option value="gemini-pro">gemini-pro</option>
          </select>
        </div>
      </div>

      <!-- OpenAI CompatibleË®≠ÂÆö„Çø„Éñ -->
      <div id="openai-compatible-tab" class="tab-content">
        <h3 data-i18n="openaiCompatibleSettings">OpenAI Compatible Ë®≠ÂÆö</h3>
        
        <!-- „Éó„É™„Çª„ÉÉ„ÉàÈÅ∏Êäû -->
        <div class="input-group">
          <label for="openaiPreset" data-i18n="preset">„Éó„É™„Çª„ÉÉ„Éà</label>
          <select id="openaiPreset">
            <option value="openai">OpenAI</option>
            <option value="chatgpt">ChatGPT</option>
            <option value="azure">Azure OpenAI</option>
            <option value="anthropic">Anthropic Claude</option>
            <option value="groq">Groq</option>
            <option value="deepseek">DeepSeek</option>
            <option value="ollama">Ollama</option>
            <option value="custom">Custom</option>
          </select>
        </div>
        
        <!-- „Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà -->
        <div class="input-group">
          <label for="openaiEndpoint" data-i18n="endpoint">„Ç®„É≥„Éâ„Éù„Ç§„É≥„Éà</label>
          <input type="url" id="openaiEndpoint" data-i18n-placeholder="placeholderOpenAIEndpoint">
        </div>
        
        <!-- API „Ç≠„Éº -->
        <div class="input-group">
          <label for="openaiApiKey" data-i18n="apiKey">API „Ç≠„Éº</label>
          <input type="password" id="openaiApiKey" data-i18n-placeholder="placeholderOpenAIApiKey">
        </div>
        
        <!-- „É¢„Éá„É´ -->
        <div class="input-group">
          <label for="openaiModel" data-i18n="model">„É¢„Éá„É´</label>
          <select id="openaiModel">
            <option value="gpt-4o">GPT-4o</option>
            <option value="gpt-4o-mini">GPT-4o mini</option>
            <option value="gpt-4">GPT-4</option>
            <option value="gpt-4-turbo">GPT-4 Turbo</option>
            <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
          </select>
        </div>
        
        <!-- AzureÁî®ËøΩÂä†Ë®≠ÂÆö -->
        <div id="azureSettings" class="azure-settings" style="display: none;">
          <div class="input-group">
            <label for="azureApiVersion" data-i18n="apiVersion">API „Éê„Éº„Ç∏„Éß„É≥</label>
            <select id="azureApiVersion">
              <option value="2024-02-15-preview">2024-02-15-preview</option>
              <option value="2023-12-01-preview">2023-12-01-preview</option>
              <option value="2023-05-15">2023-05-15</option>
            </select>
          </div>
          <div class="input-group">
            <label for="azureDeployment" data-i18n="deploymentName">„Éá„Éó„É≠„Ç§„É°„É≥„ÉàÂêç</label>
            <input type="text" id="azureDeployment" data-i18n-placeholder="placeholderDeploymentName">
          </div>
        </div>
        
        <!-- „Ç´„Çπ„Çø„É†„É¢„Éá„É´ÂÖ•Âäõ -->
        <div id="customModelInput" class="input-group" style="display: none;">
          <label for="customModel" data-i18n="customModel">„Ç´„Çπ„Çø„É†„É¢„Éá„É´</label>
          <input type="text" id="customModel" data-i18n-placeholder="placeholderCustomModel">
        </div>
        
        <!-- ChatGPTÁî®Organization ID -->
        <div id="organizationInput" class="input-group" style="display: none;">
          <label for="organizationId" data-i18n="organizationId">Organization ID („Ç™„Éó„Ç∑„Éß„É≥)</label>
          <input type="text" id="organizationId" data-i18n-placeholder="placeholderOrganizationId">
        </div>
      </div>


      <!-- AWS BedrockË®≠ÂÆö„Çø„Éñ -->
      <div id="aws-bedrock-tab" class="tab-content">
        <h3 data-i18n="awsBedrockSettings">AWS Bedrock Ë®≠ÂÆö</h3>
        <div class="input-group">
          <label for="awsAccessKeyId" data-i18n="awsAccessKeyId">AWS Access Key ID</label>
          <input type="password" id="awsAccessKeyId" data-i18n-placeholder="placeholderAWSAccessKeyId">
        </div>
        <div class="input-group">
          <label for="awsSecretAccessKey" data-i18n="awsSecretAccessKey">AWS Secret Access Key</label>
          <input type="password" id="awsSecretAccessKey" data-i18n-placeholder="placeholderAWSSecretAccessKey">
        </div>
        <div class="input-group">
          <label for="awsSessionToken" data-i18n="awsSessionToken">AWS Session Token („Ç™„Éó„Ç∑„Éß„É≥)</label>
          <input type="password" id="awsSessionToken" data-i18n-placeholder="placeholderAWSSessionToken">
        </div>
        <div class="input-group">
          <label for="awsRegion" data-i18n="awsRegion">AWS Region</label>
          <select id="awsRegion">
            <option value="us-east-1">US East (N. Virginia)</option>
            <option value="us-west-2">US West (Oregon)</option>
            <option value="eu-west-1">Europe (Ireland)</option>
            <option value="ap-southeast-1">Asia Pacific (Singapore)</option>
            <option value="ap-northeast-1">Asia Pacific (Tokyo)</option>
          </select>
        </div>
        <div class="input-group">
          <label for="awsBedrockModel" data-i18n="model">„É¢„Éá„É´</label>
          <select id="awsBedrockModel">
            <option value="anthropic.claude-3-5-sonnet-20241022-v2:0">Claude 3.5 Sonnet v2</option>
            <option value="anthropic.claude-3-5-sonnet-20240620-v1:0">Claude 3.5 Sonnet v1</option>
            <option value="anthropic.claude-3-haiku-20240307-v1:0">Claude 3 Haiku</option>
            <option value="anthropic.claude-3-sonnet-20240229-v1:0">Claude 3 Sonnet</option>
            <option value="anthropic.claude-3-opus-20240229-v1:0">Claude 3 Opus</option>
            <option value="amazon.titan-text-premier-v1:0">Titan Text Premier</option>
            <option value="amazon.titan-text-express-v1">Titan Text Express</option>
            <option value="cohere.command-r-plus-v1:0">Command R+</option>
            <option value="cohere.command-r-v1:0">Command R</option>
            <option value="meta.llama3-2-90b-instruct-v1:0">Llama 3.2 90B Instruct</option>
            <option value="meta.llama3-2-11b-instruct-v1:0">Llama 3.2 11B Instruct</option>
            <option value="meta.llama3-2-3b-instruct-v1:0">Llama 3.2 3B Instruct</option>
            <option value="meta.llama3-2-1b-instruct-v1:0">Llama 3.2 1B Instruct</option>
          </select>
        </div>
      </div>

      <!-- ÂÖ®‰ΩìË®≠ÂÆö„Çø„Éñ -->
      <div id="general-tab" class="tab-content">
        <h3 data-i18n="generalSettings">ÂÖ®‰ΩìË®≠ÂÆö</h3>
        <div class="input-group">
          <label for="defaultProvider" data-i18n="defaultProvider">„Éá„Éï„Ç©„É´„Éà AI „Éó„É≠„Éê„Ç§„ÉÄ„Éº</label>
          <select id="defaultProvider">
            <option value="vertex-ai">Vertex AI</option>
            <option value="openai-compatible">OpenAI Compatible</option>
            <option value="aws-bedrock">AWS Bedrock</option>
          </select>
        </div>
        
        <!-- OpenAI Compatible „Éó„É™„Çª„ÉÉ„ÉàÈÅ∏Êäû -->
        <div class="input-group" id="openaiCompatiblePresetGroup" style="display: none;">
          <label for="openaiCompatiblePreset" data-i18n="openaiCompatiblePreset">OpenAI Compatible „Éó„É™„Çª„ÉÉ„Éà</label>
          <select id="openaiCompatiblePreset">
            <option value="openai">OpenAI</option>
            <option value="chatgpt">ChatGPT</option>
            <option value="azure">Azure OpenAI</option>
            <option value="anthropic">Anthropic Claude</option>
            <option value="groq">Groq</option>
            <option value="deepseek">DeepSeek</option>
            <option value="ollama">Ollama</option>
            <option value="custom">Custom</option>
          </select>
        </div>
        
        <div class="custom-instructions">
          <h4 data-i18n="customInstructions">„Ç´„Çπ„Çø„É†„Ç§„É≥„Çπ„Éà„É©„ÇØ„Ç∑„Éß„É≥</h4>
          <div class="input-group">
            <label for="customInstructionsText" data-i18n="customInstructionsText">„Ç∑„Çπ„ÉÜ„É†„Éó„É≠„É≥„Éó„Éà</label>
            <textarea 
              id="customInstructionsText" 
              rows="4" 
              data-i18n-placeholder="placeholderCustomInstructions"
              class="custom-instructions-textarea"
            ></textarea>
            <small class="help-text" data-i18n="customInstructionsHelp">
              „Åô„Åπ„Å¶„ÅÆAI API„Å´ÈÅ©Áî®„Åï„Çå„ÇãÂÖ±ÈÄö„ÅÆ„Ç∑„Çπ„ÉÜ„É†„Éó„É≠„É≥„Éó„Éà„Åß„Åô„ÄÇÁ©∫Ê¨Ñ„ÅÆÂ†¥Âêà„ÅØ„Éá„Éï„Ç©„É´„Éà„ÅÆÂãï‰Ωú„Å´„Å™„Çä„Åæ„Åô„ÄÇ
            </small>
          </div>
        </div>

        <div class="ui-settings">
          <h4 data-i18n="uiSettings">UIË®≠ÂÆö</h4>
          
          <div class="input-group">
            <label for="language" data-i18n="language">Ë®ÄË™û</label>
            <select id="language">
              <option value="ja">Êó•Êú¨Ë™û</option>
              <option value="en">English</option>
            </select>
          </div>
          
          <div class="input-group">
            <label for="fontSize" data-i18n="fontSize">„Éï„Ç©„É≥„Éà„Çµ„Ç§„Ç∫</label>
            <select id="fontSize">
              <option value="8">8pt</option>
              <option value="9">9pt</option>
              <option value="10">10pt</option>
              <option value="11">11pt</option>
              <option value="12" selected>12pt</option>
              <option value="13">13pt</option>
              <option value="14">14pt</option>
              <option value="15">15pt</option>
              <option value="16">16pt</option>
              <option value="17">17pt</option>
              <option value="18">18pt</option>
              <option value="19">19pt</option>
              <option value="20">20pt</option>
              <option value="21">21pt</option>
              <option value="22">22pt</option>
              <option value="23">23pt</option>
              <option value="24">24pt</option>
            </select>
          </div>

          <div class="input-group">
            <label class="checkbox-label">
              <input type="checkbox" id="useShiftEnter" checked>
              <span class="checkmark"></span>
              <span data-i18n="useShiftEnter">Shift+Enter„ÅßÈÄÅ‰ø°</span>
            </label>
            <small class="help-text" data-i18n="useShiftEnterHelp">„Ç™„Éï„ÅÆÂ†¥Âêà„ÄÅEnter„Ç≠„Éº„ÅßÈÄÅ‰ø°„Åï„Çå„Åæ„Åô</small>
          </div>
        </div>

        <div class="export-settings">
          <h4 data-i18n="exportSettings">„Ç®„ÇØ„Çπ„Éù„Éº„ÉàË®≠ÂÆö</h4>
          
          <div class="input-group">
            <label data-i18n="exportChatHistory">„ÉÅ„É£„ÉÉ„ÉàÂ±•Ê≠¥„ÅÆ„Ç®„ÇØ„Çπ„Éù„Éº„Éà</label>
            <div class="export-buttons">
              <button id="exportAllHistory" class="export-button" data-i18n="exportAllHistory">üìÑ ÂÖ®Â±•Ê≠¥„Çí„Ç®„ÇØ„Çπ„Éù„Éº„Éà</button>
              <button id="exportCurrentHistory" class="export-button" data-i18n="exportCurrentHistory">üìã ÁèæÂú®„ÅÆAIÂ±•Ê≠¥„Çí„Ç®„ÇØ„Çπ„Éù„Éº„Éà</button>
              <button id="clearLogsButton" class="clear-logs-btn" data-i18n="clearLogs" title="Clear Chat History">üóëÔ∏è „É≠„Ç∞„Çí„ÇØ„É™„Ç¢</button>
            </div>
            <small class="help-text" data-i18n="exportHelpText">
              Â±•Ê≠¥„ÅØMarkdownÂΩ¢Âºè„Åß„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åï„Çå„Åæ„Åô
            </small>
          </div>
        </div>
      </div>
        
      <div class="button-group">
        <button id="cancelConfig" class="cancel-button" data-i18n="cancel">„Ç≠„É£„É≥„Çª„É´</button>
        <button id="saveConfig" class="save-button" data-i18n="saveSettings">Ë®≠ÂÆö„Çí‰øùÂ≠ò</button>
      </div>
    </div>
  </div>

  <!-- „ÉÅ„É£„ÉÉ„ÉàÁîªÈù¢ -->
  <div id="chatScreen" class="screen hidden">
    <div class="chat-container">
      <header class="chat-header">
        <h1 id="chatTitle" data-i18n="appTitle">AI Assistant</h1>
        <div class="header-buttons">
          <button id="settingsButton" class="settings-btn"><img src="icons/setting.png" alt="Ë®≠ÂÆö" class="settings-icon"></button>
        </div>
      </header>
      
      <main class="chat-main">
        <div class="messages" id="messages">
          <div class="welcome-message">
            <p data-i18n="welcomeMessage">Gemini AI„Å∏„Çà„ÅÜ„Åì„ÅùÔºÅ‰Ωï„Åã„ÅäÊâã‰ºù„ÅÑ„Åß„Åç„Çã„Åì„Å®„ÅØ„ÅÇ„Çä„Åæ„Åô„ÅãÔºü</p>
          </div>
        </div>
        
        <div class="input-container">
          <div class="resize-handle" id="resizeHandle">
            <div class="resize-bar"></div>
          </div>
          <div class="input-controls-top">
            <label class="checkbox-control">
              <input type="checkbox" id="includePageContent" />
              <span class="checkmark-custom"></span>
              <span data-i18n="includePageContent">üìÑ „Éö„Éº„Ç∏ÂÜÖÂÆπ„ÇíÂê´„ÇÅ„Çã</span>
            </label>
            <label class="checkbox-control">
              <input type="checkbox" id="includeSelectedText" />
              <span class="checkmark-custom"></span>
              <span data-i18n="includeSelectedText">üìù ÈÅ∏Êäû„ÉÜ„Ç≠„Çπ„Éà„ÇíÂê´„ÇÅ„Çã</span>
            </label>
          </div>
          <div class="input-wrapper">
            <textarea 
              id="messageInput" 
              data-i18n-placeholder="messageInputPlaceholder"
              rows="2"
            ></textarea>
            <button id="sendButton" class="send-button">
              <span id="sendIcon">üì§</span>
              <span id="loadingIcon" class="loading hidden">‚è≥</span>
            </button>
          </div>
        </div>
      </main>
    </div>
  </div>
  
  <script src="scripts/marked.min.js"></script>
  <script src="scripts/dompurify.min.js"></script>
  <script src="scripts/i18n.js"></script>
  <script src="scripts/security-manager.js"></script>
  <script src="scripts/crypto-utils.js"></script>
  <script src="scripts/openai-compatible.js"></script>
  <script src="scripts/aws-bedrock.js"></script>
  <script src="scripts/sidepanel.js"></script>
</body>
</html>